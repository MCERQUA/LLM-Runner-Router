<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: config/ModelTemplates.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: config/ModelTemplates.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * ðŸŽ¨ Model-specific Chat Templates
 * Automatically provides the correct template for each model type
 */

class ModelTemplates {
    static templates = {
        // Llama family templates
        llama: {
            name: 'Llama',
            systemPrefix: '[INST] &lt;&lt;SYS>>\n',
            systemSuffix: '\n&lt;&lt;/SYS>>\n\n',
            userPrefix: '[INST] ',
            userSuffix: ' [/INST]',
            assistantPrefix: ' ',
            assistantSuffix: ' &lt;/s>',
            messageSeparator: ' ',
            stopSequences: ['[INST]', '&lt;/s>'],
            description: 'Llama 2 instruction format'
        },
        
        // Alpaca/Vicuna style
        alpaca: {
            name: 'Alpaca',
            systemPrefix: '',
            systemSuffix: '\n\n',
            userPrefix: '### Instruction:\n',
            userSuffix: '\n\n',
            assistantPrefix: '### Response:\n',
            assistantSuffix: '\n\n',
            messageSeparator: '',
            stopSequences: ['### Instruction:', '### Response:'],
            description: 'Alpaca/Vicuna instruction format'
        },
        
        // ChatML format (used by many models)
        chatml: {
            name: 'ChatML',
            systemPrefix: '&lt;|im_start|>system\n',
            systemSuffix: '&lt;|im_end|>\n',
            userPrefix: '&lt;|im_start|>user\n',
            userSuffix: '&lt;|im_end|>\n',
            assistantPrefix: '&lt;|im_start|>assistant\n',
            assistantSuffix: '&lt;|im_end|>\n',
            messageSeparator: '',
            stopSequences: ['&lt;|im_end|>', '&lt;|im_start|>'],
            description: 'ChatML format (OpenAI style)'
        },
        
        // Mistral/Mixtral format
        mistral: {
            name: 'Mistral',
            systemPrefix: '&lt;s>[INST] ',
            systemSuffix: '\n\n',
            userPrefix: '[INST] ',
            userSuffix: ' [/INST]',
            assistantPrefix: ' ',
            assistantSuffix: '&lt;/s>',
            messageSeparator: ' ',
            stopSequences: ['[INST]', '&lt;/s>'],
            description: 'Mistral instruction format'
        },
        
        // Phi format
        phi: {
            name: 'Phi',
            systemPrefix: 'Instruct: ',
            systemSuffix: '\n',
            userPrefix: 'Instruct: ',
            userSuffix: '\n',
            assistantPrefix: 'Output: ',
            assistantSuffix: '\n',
            messageSeparator: '\n',
            stopSequences: ['Instruct:', '&lt;|endoftext|>'],
            description: 'Microsoft Phi format'
        },
        
        // TinyLlama format
        tinyllama: {
            name: 'TinyLlama',
            systemPrefix: '&lt;|system|>\n',
            systemSuffix: '&lt;/s>\n',
            userPrefix: '&lt;|user|>\n',
            userSuffix: '&lt;/s>\n',
            assistantPrefix: '&lt;|assistant|>\n',
            assistantSuffix: '&lt;/s>\n',
            messageSeparator: '',
            stopSequences: ['&lt;/s>', '&lt;|user|>'],
            description: 'TinyLlama chat format'
        },
        
        // CodeLlama format
        codellama: {
            name: 'CodeLlama',
            systemPrefix: '[INST] &lt;&lt;SYS>>\nYou are a helpful coding assistant.\n&lt;&lt;/SYS>>\n\n',
            systemSuffix: '',
            userPrefix: '[INST] ',
            userSuffix: ' [/INST]\n',
            assistantPrefix: '',
            assistantSuffix: '\n',
            messageSeparator: '',
            stopSequences: ['[INST]', '&lt;/s>'],
            description: 'CodeLlama instruction format'
        },
        
        // Orca format
        orca: {
            name: 'Orca',
            systemPrefix: '### System:\n',
            systemSuffix: '\n\n',
            userPrefix: '### User:\n',
            userSuffix: '\n\n',
            assistantPrefix: '### Assistant:\n',
            assistantSuffix: '\n\n',
            messageSeparator: '',
            stopSequences: ['### User:', '### Assistant:'],
            description: 'Orca instruction format'
        },
        
        // Wizard format
        wizard: {
            name: 'Wizard',
            systemPrefix: '',
            systemSuffix: '\n\n',
            userPrefix: 'USER: ',
            userSuffix: '\n',
            assistantPrefix: 'ASSISTANT: ',
            assistantSuffix: '\n',
            messageSeparator: '',
            stopSequences: ['USER:', 'ASSISTANT:'],
            description: 'Wizard model format'
        },
        
        // StableLM format
        stablelm: {
            name: 'StableLM',
            systemPrefix: '&lt;|SYSTEM|>',
            systemSuffix: '\n',
            userPrefix: '&lt;|USER|>',
            userSuffix: '\n',
            assistantPrefix: '&lt;|ASSISTANT|>',
            assistantSuffix: '\n',
            messageSeparator: '',
            stopSequences: ['&lt;|USER|>', '&lt;|ENDOFTEXT|>'],
            description: 'StableLM instruction format'
        },
        
        // Default/Generic format
        default: {
            name: 'Default',
            systemPrefix: 'System: ',
            systemSuffix: '\n\n',
            userPrefix: 'User: ',
            userSuffix: '\n\n',
            assistantPrefix: 'Assistant: ',
            assistantSuffix: '\n\n',
            messageSeparator: '',
            stopSequences: ['User:', 'Human:'],
            description: 'Generic chat format'
        }
    };

    /**
     * Model ID to template mapping
     */
    static modelMappings = {
        // Specific model mappings
        'tinyllama-1.1b': 'tinyllama',
        'tinyllama-1.1b-chat': 'tinyllama',
        'phi-2': 'phi',
        'phi-3': 'phi',
        'mistral-7b-instruct': 'mistral',
        'mixtral-8x7b': 'mistral',
        'llama-2-7b-chat': 'llama',
        'llama-2-13b-chat': 'llama',
        'llama-2-70b-chat': 'llama',
        'codellama-7b': 'codellama',
        'codellama-13b': 'codellama',
        'codellama-34b': 'codellama',
        'wizard-vicuna-7b': 'wizard',
        'wizard-vicuna-13b': 'wizard',
        'wizardlm': 'wizard',
        'orca-mini-3b': 'orca',
        'orca-2': 'orca',
        'stablelm-3b': 'stablelm',
        'stablelm-2': 'stablelm',
        'vicuna': 'alpaca',
        'alpaca': 'alpaca',
        
        // Pattern-based mappings (checked if exact match not found)
        patterns: [
            { pattern: /tinyllama/i, template: 'tinyllama' },
            { pattern: /phi-?\d/i, template: 'phi' },
            { pattern: /mistral|mixtral/i, template: 'mistral' },
            { pattern: /llama-?2/i, template: 'llama' },
            { pattern: /llama-?3/i, template: 'llama' },
            { pattern: /codellama/i, template: 'codellama' },
            { pattern: /wizard/i, template: 'wizard' },
            { pattern: /orca/i, template: 'orca' },
            { pattern: /stable-?lm/i, template: 'stablelm' },
            { pattern: /vicuna/i, template: 'alpaca' },
            { pattern: /alpaca/i, template: 'alpaca' },
            { pattern: /chatml|openai/i, template: 'chatml' }
        ]
    };

    /**
     * Get the appropriate template for a model
     */
    static getTemplateForModel(modelId, modelName = '') {
        if (!modelId &amp;&amp; !modelName) {
            return this.templates.default;
        }

        // Normalize the model ID
        const normalizedId = modelId.toLowerCase().replace(/[._]/g, '-');
        
        // Check exact mapping first
        if (this.modelMappings[normalizedId]) {
            return this.templates[this.modelMappings[normalizedId]];
        }

        // Check pattern-based mappings
        const combinedName = `${modelId} ${modelName}`.toLowerCase();
        for (const { pattern, template } of this.modelMappings.patterns) {
            if (pattern.test(combinedName)) {
                return this.templates[template];
            }
        }

        // Default fallback
        return this.templates.default;
    }

    /**
     * Format a conversation using the model's template
     */
    static formatConversation(messages, modelId, modelName = '') {
        const template = this.getTemplateForModel(modelId, modelName);
        let formatted = '';

        for (const message of messages) {
            switch (message.role) {
                case 'system':
                    formatted += template.systemPrefix + message.content + template.systemSuffix;
                    break;
                case 'user':
                    formatted += template.userPrefix + message.content + template.userSuffix;
                    break;
                case 'assistant':
                    formatted += template.assistantPrefix + message.content + template.assistantSuffix;
                    break;
            }
            formatted += template.messageSeparator;
        }

        return formatted;
    }

    /**
     * Get all available templates
     */
    static getAllTemplates() {
        return Object.entries(this.templates).map(([key, template]) => ({
            id: key,
            ...template
        }));
    }

    /**
     * Add or update a custom template
     */
    static addCustomTemplate(id, template) {
        this.templates[id] = {
            ...template,
            custom: true
        };
    }

    /**
     * Add model mapping
     */
    static addModelMapping(modelId, templateId) {
        const normalizedId = modelId.toLowerCase().replace(/[._]/g, '-');
        this.modelMappings[normalizedId] = templateId;
    }
}


export default ModelTemplates;
export { ModelTemplates };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ABTestingManager.html">ABTestingManager</a></li><li><a href="AuditLogger.html">AuditLogger</a></li><li><a href="AuthMiddleware.html">AuthMiddleware</a></li><li><a href="BPETokenizer.html">BPETokenizer</a></li><li><a href="BaseEngine.html">BaseEngine</a></li><li><a href="BaseLoader.html">BaseLoader</a></li><li><a href="BinaryLoader.html">BinaryLoader</a></li><li><a href="BinaryModel.html">BinaryModel</a></li><li><a href="BitNetLoader.html">BitNetLoader</a></li><li><a href="ConversionConfig.html">ConversionConfig</a></li><li><a href="ConversionResult.html">ConversionResult</a></li><li><a href="EnterpriseAuthManager.html">EnterpriseAuthManager</a></li><li><a href="EnterpriseManager.html">EnterpriseManager</a></li><li><a href="EnterpriseRouter.html">EnterpriseRouter</a></li><li><a href="ErrorHandler.html">ErrorHandler</a></li><li><a href="FormatConverter.html">FormatConverter</a></li><li><a href="GGUFLoader.html">GGUFLoader</a></li><li><a href="GGUFModel.html">GGUFModel</a></li><li><a href="GRPCClient.html">GRPCClient</a></li><li><a href="LLMRouter.html">LLMRouter</a></li><li><a href="MockLoader.html">MockLoader</a></li><li><a href="MockModel.html">MockModel</a></li><li><a href="ModelError.html">ModelError</a></li><li><a href="ModelInterface.html">ModelInterface</a></li><li><a href="ModelQuantizer.html">ModelQuantizer</a></li><li><a href="ModelRegistry.html">ModelRegistry</a></li><li><a href="ModelTemplates.html">ModelTemplates</a></li><li><a href="MultiTenancyManager.html">MultiTenancyManager</a></li><li><a href="Pipeline.html">Pipeline</a></li><li><a href="PyTorchLoader.html">PyTorchLoader</a></li><li><a href="PyTorchModel.html">PyTorchModel</a></li><li><a href="QuantizationConfig.html">QuantizationConfig</a></li><li><a href="QuantizationResult.html">QuantizationResult</a></li><li><a href="Router.html">Router</a></li><li><a href="SLAMonitor.html">SLAMonitor</a></li><li><a href="SentencePieceTokenizer.html">SentencePieceTokenizer</a></li><li><a href="SimpleLoader.html">SimpleLoader</a></li><li><a href="SimpleModel.html">SimpleModel</a></li><li><a href="TokenizationResult.html">TokenizationResult</a></li><li><a href="TokenizerConfig.html">TokenizerConfig</a></li><li><a href="UniversalTokenizer.html">UniversalTokenizer</a></li><li><a href="ValidationConfig.html">ValidationConfig</a></li><li><a href="ValidationSuite.html">ValidationSuite</a></li><li><a href="ValidationSuiteResult.html">ValidationSuiteResult</a></li><li><a href="ValidationTestResult.html">ValidationTestResult</a></li><li><a href="WordPieceTokenizer.html">WordPieceTokenizer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Architectures">Architectures</a></li><li><a href="global.html#AuditEventTypes">AuditEventTypes</a></li><li><a href="global.html#AuthMethods">AuthMethods</a></li><li><a href="global.html#BreachSeverity">BreachSeverity</a></li><li><a href="global.html#Capabilities">Capabilities</a></li><li><a href="global.html#ComplianceFrameworks">ComplianceFrameworks</a></li><li><a href="global.html#EnterpriseFeatures">EnterpriseFeatures</a></li><li><a href="global.html#ExperimentStatus">ExperimentStatus</a></li><li><a href="global.html#IsolationLevels">IsolationLevels</a></li><li><a href="global.html#ModelFormat">ModelFormat</a></li><li><a href="global.html#ModelFormats">ModelFormats</a></li><li><a href="global.html#Permissions">Permissions</a></li><li><a href="global.html#QuantizationMethod">QuantizationMethod</a></li><li><a href="global.html#QuantizationPrecision">QuantizationPrecision</a></li><li><a href="global.html#QuotaTypes">QuotaTypes</a></li><li><a href="global.html#RiskLevels">RiskLevels</a></li><li><a href="global.html#RoutingStrategies">RoutingStrategies</a></li><li><a href="global.html#SLAMetricTypes">SLAMetricTypes</a></li><li><a href="global.html#SLAStatus">SLAStatus</a></li><li><a href="global.html#SessionTypes">SessionTypes</a></li><li><a href="global.html#SplittingAlgorithms">SplittingAlgorithms</a></li><li><a href="global.html#StatisticalTests">StatisticalTests</a></li><li><a href="global.html#TimeWindows">TimeWindows</a></li><li><a href="global.html#TokenizerType">TokenizerType</a></li><li><a href="global.html#UserRoles">UserRoles</a></li><li><a href="global.html#ValidationSeverity">ValidationSeverity</a></li><li><a href="global.html#ValidationTestType">ValidationTestType</a></li><li><a href="global.html#adjustTimeouts">adjustTimeouts</a></li><li><a href="global.html#attemptRecovery">attemptRecovery</a></li><li><a href="global.html#checkConnectivity">checkConnectivity</a></li><li><a href="global.html#clearCache">clearCache</a></li><li><a href="global.html#colors">colors</a></li><li><a href="global.html#createEnterpriseExpressRoutes">createEnterpriseExpressRoutes</a></li><li><a href="global.html#createEnterpriseRouter">createEnterpriseRouter</a></li><li><a href="global.html#createEnterpriseWebSocketHandlers">createEnterpriseWebSocketHandlers</a></li><li><a href="global.html#createMissingResources">createMissingResources</a></li><li><a href="global.html#defaultEnterpriseConfig">defaultEnterpriseConfig</a></li><li><a href="global.html#emergencyShutdown">emergencyShutdown</a></li><li><a href="global.html#enterpriseVersion">enterpriseVersion</a></li><li><a href="global.html#errorMonitoringMiddleware">errorMonitoringMiddleware</a></li><li><a href="global.html#escalateError">escalateError</a></li><li><a href="global.html#executeRecovery">executeRecovery</a></li><li><a href="global.html#getEnabledFeatures">getEnabledFeatures</a></li><li><a href="global.html#getMonitoringStatus">getMonitoringStatus</a></li><li><a href="global.html#getStats">getStats</a></li><li><a href="global.html#gracefulShutdown">gracefulShutdown</a></li><li><a href="global.html#handleCriticalError">handleCriticalError</a></li><li><a href="global.html#handleMemoryLeak">handleMemoryLeak</a></li><li><a href="global.html#httpMonitoringMiddleware">httpMonitoringMiddleware</a></li><li><a href="global.html#isFeatureEnabled">isFeatureEnabled</a></li><li><a href="global.html#logError">logError</a></li><li><a href="global.html#performHealthCheck">performHealthCheck</a></li><li><a href="global.html#recordCustomMetric">recordCustomMetric</a></li><li><a href="global.html#registerAlertRule">registerAlertRule</a></li><li><a href="global.html#registerDependency">registerDependency</a></li><li><a href="global.html#registerHealthCheck">registerHealthCheck</a></li><li><a href="global.html#reinstallDependencies">reinstallDependencies</a></li><li><a href="global.html#reload">reload</a></li><li><a href="global.html#restartProcess">restartProcess</a></li><li><a href="global.html#retryConnection">retryConnection</a></li><li><a href="global.html#selectRecoveryStrategy">selectRecoveryStrategy</a></li><li><a href="global.html#setupHandlers">setupHandlers</a></li><li><a href="global.html#setupMonitoring">setupMonitoring</a></li><li><a href="global.html#softRestart">softRestart</a></li><li><a href="global.html#startHealthMonitoring">startHealthMonitoring</a></li><li><a href="global.html#startPerformanceProfile">startPerformanceProfile</a></li><li><a href="global.html#validateEnterpriseConfig">validateEnterpriseConfig</a></li><li><a href="global.html#withCacheMonitoring">withCacheMonitoring</a></li><li><a href="global.html#withDatabaseMonitoring">withDatabaseMonitoring</a></li><li><a href="global.html#withModelMonitoring">withModelMonitoring</a></li><li><a href="global.html#withQueueMonitoring">withQueueMonitoring</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Mon Aug 18 2025 01:43:35 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
